<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„ ì²œì  ë©´ì—­ê²°í•ì¦: ì‹¬ì¸µ ë¶„ì„ ë° ì„ìƒ ê°€ì´ë“œ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Custom Styles for Chart Containers and Typography -->
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #F3F4F6; /* Light gray/warm neutral */
            color: #1F2937;
        }

        /* Chart Container Strict Styling */
        .chart-wrapper {
            position: relative;
            width: 100%;
            max-width: 700px; /* Max width to prevent stretching */
            height: 350px;    /* Default height */
            margin: 0 auto;   /* Center horizontally */
        }

        @media (max-width: 640px) {
            .chart-wrapper {
                height: 300px;
            }
        }

        /* Transition Utilities */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .nav-active {
            border-bottom: 2px solid #2563EB; /* Blue-600 */
            color: #1E40AF; /* Blue-800 */
            font-weight: 700;
        }
        
        /* Custom Scrollbar for content areas */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #F1F1F1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #D1D5DB;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #9CA3AF;
        }
    </style>

    <!-- Placeholder Comments Required by Prompt -->
    <!-- Chosen Palette: Clinical Blue & Warm Neutral. Background: #F3F4F6 (Cool Gray 100), Primary: #2563EB (Blue 600), Accent: #10B981 (Emerald 500). Designed for clarity, professionalism, and reduced eye strain during reading. -->
    
    <!-- Application Structure Plan:
         1. Dashboard (Overview): High-level statistics on prevalence and the "10 Warning Signs" interactive grid. Why? Sets the context and importance of the disease.
         2. Pathophysiology (The Mechanism): Interactive "Immune Development Tree". Users click stages of cell maturation to see where defects occur. Why? Connects abstract biological processes to specific disease names (e.g., XLA, SCID).
         3. Diagnosis (The Pathway): A step-by-step interactive algorithm. Users progress from History -> Screening -> Advanced Testing. Why? Mimics the clinician's thought process.
         4. Treatment (Management): Comparative view of therapies (IVIG vs HSCT) and a survival trend chart. Why? Highlights outcomes and management strategies.
         This structure moves from "What is it?" -> "How does it happen?" -> "How do we find it?" -> "How do we treat it?", creating a logical learning journey.
    -->

    <!-- Visualization & Content Choices:
         1. Prevalence (Dashboard): Doughnut Chart. Goal: Inform about the dominance of Antibody Deficiencies. Interaction: Tooltip details.
         2. Warning Signs (Dashboard): Interactive Card Grid. Goal: Educate on screening. Interaction: Hover/Click to reveal clinical nuance.
         3. Immune Tree (Pathophysiology): Flexbox-based flowchart (HTML/CSS). Goal: Visualize defects. Interaction: Click node -> Update detail panel. (No SVG).
         4. Diagnostic Funnel (Diagnosis): Vertical Step-Stepper. Goal: Show the narrowing of differential diagnosis.
         5. Survival Trends (Treatment): Line Chart. Goal: Show impact of early HSCT. Interaction: Toggle datasets.
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. All visuals are Canvas (Chart.js) or styled HTML elements.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex flex-col h-screen overflow-hidden text-sm md:text-base">

    <!-- Header / Navigation -->
    <header class="bg-white shadow-sm z-10 flex-none">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Title -->
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold mr-3 text-lg">IEI</div>
                    <div>
                        <h1 class="font-bold text-gray-900 leading-tight">ì„ ì²œì  ë©´ì—­ê²°í•ì¦</h1>
                        <p class="text-xs text-gray-500">Inborn Errors of Immunity (IEI) Report</p>
                    </div>
                </div>
                
                <!-- Desktop Nav -->
                <nav class="hidden md:flex space-x-8">
                    <button onclick="app.navigate('dashboard')" id="nav-dashboard" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 font-medium transition-colors">ê°œìš” ë° ì—­í•™</button>
                    <button onclick="app.navigate('patho')" id="nav-patho" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 font-medium transition-colors">ë³‘íƒœìƒë¦¬</button>
                    <button onclick="app.navigate('diagnosis')" id="nav-diagnosis" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 font-medium transition-colors">ì§„ë‹¨ ì ‘ê·¼</button>
                    <button onclick="app.navigate('treatment')" id="nav-treatment" class="nav-btn text-gray-500 hover:text-gray-700 px-3 py-2 font-medium transition-colors">ì¹˜ë£Œ ê°€ì´ë“œë¼ì¸</button>
                </nav>
                
                <!-- Mobile Menu Button (Simple implementation) -->
                <button class="md:hidden text-gray-500" onclick="alert('í™”ë©´ì„ ê°€ë¡œë¡œ ëŒë¦¬ê±°ë‚˜ ë” í° í™”ë©´ì—ì„œ ìµœì ì˜ ê²½í—˜ì„ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')">
                    <span>ë©”ë‰´</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="main-container" class="flex-1 overflow-y-auto bg-gray-50 p-4 md:p-8 custom-scrollbar">
        <!-- Content will be injected here by JS -->
    </main>

    <!-- JavaScript Application Logic -->
    <script>
        // --- DATA STORE ---
        const reportData = {
            dashboard: {
                intro: "ì„ ì²œì  ë©´ì—­ê²°í•ì¦(Inborn Errors of Immunity, IEI)ì€ ìœ ì „ì  ê²°í•¨ìœ¼ë¡œ ì¸í•´ ë©´ì—­ê³„ì˜ í•œ ë¶€ë¶„ ì´ìƒì´ ì œëŒ€ë¡œ ê¸°ëŠ¥í•˜ì§€ ëª»í•˜ëŠ” ì§ˆí™˜êµ°ì…ë‹ˆë‹¤. ê³¼ê±°ì—ëŠ” í¬ê·€ ì§ˆí™˜ìœ¼ë¡œ ì—¬ê²¨ì¡Œìœ¼ë‚˜, ì§„ë‹¨ ê¸°ìˆ ì˜ ë°œë‹¬ë¡œ í˜„ì¬ 400ê°œ ì´ìƒì˜ ìœ ì „ì ê²°í•¨ì´ ë°í˜€ì¡ŒìŠµë‹ˆë‹¤. ì´ ì„¹ì…˜ì—ì„œëŠ” ì§ˆí™˜ì˜ ë¶„í¬ì™€ ì¡°ê¸° ë°œê²¬ì„ ìœ„í•œ í•µì‹¬ ê²½ê³  ì§•í›„ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.",
                stats: {
                    labels: ['í•­ì²´ ê²°í• (Antibody)', 'ë³µí•© ë©´ì—­ ê²°í• (Combined)', 'ì‹ì„¸í¬ ê²°í•¨ (Phagocytic)', 'ë³´ì²´ ê²°í• (Complement)', 'ê¸°íƒ€ (Others)'],
                    data: [65, 15, 10, 5, 5],
                    details: "í•­ì²´ ê²°í•ì¦ì´ ì „ì²´ì˜ ì•½ 65%ë¥¼ ì°¨ì§€í•˜ì—¬ ê°€ì¥ í”í•˜ë©°, ì´ëŠ” ì„ìƒì ìœ¼ë¡œ ë°˜ë³µì ì¸ ì„¸ê·  ê°ì—¼ìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤."
                },
                warningSigns: [
                    { id: 1, title: "4íšŒ ì´ìƒ", desc: "1ë…„ ë™ì•ˆ ê·€ ê°ì—¼(ì¤‘ì´ì—¼)ì´ 4íšŒ ì´ìƒ ë°œìƒ" },
                    { id: 2, title: "2íšŒ ì´ìƒ", desc: "1ë…„ ë™ì•ˆ ì‹¬ê°í•œ ë¶€ë¹„ë™ì—¼(ì¶•ë†ì¦)ì´ 2íšŒ ì´ìƒ ë°œìƒ" },
                    { id: 3, title: "í•­ìƒì œ", desc: "2ê°œì›” ì´ìƒ í•­ìƒì œë¥¼ ë³µìš©í•´ë„ íš¨ê³¼ê°€ ë¯¸ë¯¸í•¨" },
                    { id: 4, title: "íë ´", desc: "1ë…„ ë™ì•ˆ íë ´ì´ 2íšŒ ì´ìƒ ë°œìƒ" },
                    { id: 5, title: "ì„±ì¥ ë¶€ì§„", desc: "ì˜ìœ ì•„ì—ì„œ ì²´ì¤‘ ì¦ê°€ê°€ ë”ë””ê±°ë‚˜ ì„±ì¥ì´ ì§€ì—°ë¨" },
                    { id: 6, title: "ì¬ë°œì„± ë†ì–‘", desc: "í”¼ë¶€ë‚˜ ì¥ê¸°ì— ë°˜ë³µì ì¸ ê¹Šì€ ë†ì–‘ ë°œìƒ" },
                    { id: 7, title: "êµ¬ë‚´ì—¼", desc: "ì§€ì†ì ì¸ ì…ì•ˆ ê¶¤ì–‘(ì•„êµ¬ì°½) ë˜ëŠ” í”¼ë¶€ ì§„ê·  ê°ì—¼" },
                    { id: 8, title: "IV í•­ìƒì œ", desc: "ê°ì—¼ ì¹˜ë£Œë¥¼ ìœ„í•´ ì •ë§¥ ì£¼ì‚¬ í•­ìƒì œê°€ í•„ìš”í•¨" },
                    { id: 9, title: "íŒ¨í˜ˆì¦", desc: "íŒ¨í˜ˆì¦ ë“± ê¹Šì€ ì¡°ì§ì˜ ê°ì—¼ì´ 2íšŒ ì´ìƒ ë°œìƒ" },
                    { id: 10, title: "ê°€ì¡±ë ¥", desc: "ì›ì¸ ë¶ˆëª…ì˜ ì˜ì•„ ì‚¬ë§ ë“± ì„ ì²œì„± ë©´ì—­ ê²°í•ì˜ ê°€ì¡±ë ¥" }
                ]
            },
            patho: {
                intro: "ë©´ì—­ ê²°í•ì€ ì¡°í˜ˆëª¨ì„¸í¬(Stem Cell)ì—ì„œ ì„±ìˆ™í•œ ë©´ì—­ ì„¸í¬ë¡œ ë¶„í™”í•˜ëŠ” ê³¼ì • ì¤‘ íŠ¹ì • ìœ ì „ìì˜ ê²°í•¨ìœ¼ë¡œ ë°œìƒí•©ë‹ˆë‹¤. ê²°í•¨ì´ ë°œìƒí•˜ëŠ” ë‹¨ê³„ì— ë”°ë¼ ì§ˆí™˜ì˜ í‘œí˜„í˜•ì´ ê²°ì •ë©ë‹ˆë‹¤. ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì˜ ê° ë‹¨ê³„ë¥¼ í´ë¦­í•˜ì—¬ í•´ë‹¹ ë‹¨ê³„ì˜ ê²°í•¨ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ëŒ€í‘œì ì¸ ì§ˆí™˜ì„ í™•ì¸í•˜ì„¸ìš”.",
                stages: [
                    { 
                        id: 'stem', 
                        label: 'ì¡°í˜ˆëª¨ì„¸í¬ (HSC)', 
                        disease: 'ì„¸ë§ì´í˜•ì„±ì¦ (Reticular Dysgenesis)',
                        desc: 'ê°€ì¥ ì´ˆê¸° ë‹¨ê³„ì˜ ê²°í•¨ìœ¼ë¡œ, ê³¨ìˆ˜ ê¸°ëŠ¥ ë¶€ì „ì„ ë™ë°˜í•˜ë©° ë°±í˜ˆêµ¬ ì „ì²´ì˜ ê²°í•ì„ ì´ˆë˜í•©ë‹ˆë‹¤. ë§¤ìš° ì¹˜ëª…ì ì…ë‹ˆë‹¤.'
                    },
                    { 
                        id: 'lymphoid', 
                        label: 'ë¦¼í”„ê³„ ì „êµ¬ì„¸í¬', 
                        disease: 'ì¤‘ì¦ ë³µí•© ë©´ì—­ê²°í•ì¦ (SCID)',
                        desc: 'Tì„¸í¬ì™€ Bì„¸í¬ ë°œë‹¬ ëª¨ë‘ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. ADA ê²°í• ë“±ì´ í¬í•¨ë˜ë©°, "Bubble Boy" ë³‘ìœ¼ë¡œë„ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. ì¦‰ê°ì ì¸ ì¡°ì¹˜ê°€ ì—†ìœ¼ë©´ ì˜ì•„ê¸° ì‚¬ë§ ìœ„í—˜ì´ ë†’ìŠµë‹ˆë‹¤.'
                    },
                    { 
                        id: 'pre-b', 
                        label: 'Pre-B ì„¸í¬', 
                        disease: 'X-ì—°ê´€ ë¬´ê°ë§ˆê¸€ë¡œë¶ˆë¦°í˜ˆì¦ (XLA)',
                        desc: 'BTK ìœ ì „ì ëŒì—°ë³€ì´ë¡œ ì¸í•´ Bì„¸í¬ê°€ ì„±ìˆ™í•˜ì§€ ëª»í•©ë‹ˆë‹¤. í˜ˆì•¡ ë‚´ Bì„¸í¬ê°€ ê±°ì˜ ì—†ê³  ëª¨ë“  ì¢…ë¥˜ì˜ ë©´ì—­ê¸€ë¡œë¶ˆë¦°ì´ í˜„ì €íˆ ë‚®ìŠµë‹ˆë‹¤.'
                    },
                    { 
                        id: 'mature-b', 
                        label: 'ì„±ìˆ™ B ì„¸í¬', 
                        disease: 'ê³µí†µ ê°€ë³€ì„± ë©´ì—­ê²°í•ì¦ (CVID)',
                        desc: 'Bì„¸í¬ ìˆ˜ëŠ” ì •ìƒì´ê±°ë‚˜ ë‚®ì„ ìˆ˜ ìˆìœ¼ë‚˜, í˜•ì§ˆì„¸í¬(Plasma cell)ë¡œ ë¶„í™”í•˜ì—¬ í•­ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì— ì¥ì• ê°€ ìˆìŠµë‹ˆë‹¤. ì²­ì†Œë…„ê¸°ë‚˜ ì„±ì¸ê¸°ì— ì£¼ë¡œ ë°œë³‘í•©ë‹ˆë‹¤.'
                    },
                    { 
                        id: 'thymus', 
                        label: 'í‰ì„  (Tì„¸í¬ ë°œë‹¬)', 
                        disease: 'DiGeorge ì¦í›„êµ°',
                        desc: 'í‰ì„  í˜•ì„± ë¶€ì „ìœ¼ë¡œ ì¸í•´ Tì„¸í¬ ì„±ìˆ™ì— ì¥ì• ê°€ ë°œìƒí•©ë‹ˆë‹¤. ì‹¬ì¥ ê¸°í˜•, ì €ì¹¼ìŠ˜í˜ˆì¦ì„ ë™ë°˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
                    },
                    { 
                        id: 'phagocyte', 
                        label: 'ì‹ì„¸í¬ (í˜¸ì¤‘êµ¬)', 
                        disease: 'ë§Œì„± ìœ¡ì•„ì¢… ì§ˆí™˜ (CGD)',
                        desc: 'í˜¸ì¤‘êµ¬ì˜ ì‚´ê·  ì‘ìš©(í™œì„±ì‚°ì†Œ ìƒì„±)ì— í•„ìš”í•œ íš¨ì†Œ ê²°í•ìœ¼ë¡œ, ì¹´íƒˆë¼ì•„ì œ ì–‘ì„± ì„¸ê· (í¬ë„ìƒêµ¬ê·  ë“±) ë° ê³°íŒ¡ì´ ê°ì—¼ì— ì·¨ì•½í•©ë‹ˆë‹¤.'
                    }
                ]
            },
            diagnosis: {
                intro: "ì •í™•í•œ ì§„ë‹¨ì€ í™˜ìì˜ ì˜ˆí›„ë¥¼ ê²°ì •í•˜ëŠ” ê°€ì¥ ì¤‘ìš”í•œ ë‹¨ê³„ì…ë‹ˆë‹¤. ì§„ë‹¨ì€ ì˜ì‹¬(ì„ìƒ ë³‘ë ¥)ì—ì„œ ì‹œì‘í•˜ì—¬ ì„ ë³„ ê²€ì‚¬(Screening)ë¥¼ ê±°ì³ í™•ì§„ ê²€ì‚¬(ìœ ì „ì ë¶„ì„)ë¡œ ì´ì–´ì§€ëŠ” ë‹¨ê³„ì  ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤. ì•„ë˜ íë¦„ì„ ë”°ë¼ ì§„ë‹¨ í”„ë¡œì„¸ìŠ¤ë¥¼ ê²½í—˜í•´ ë³´ì„¸ìš”.",
                steps: [
                    {
                        step: 1,
                        title: "1ë‹¨ê³„: ì„ ë³„ ê²€ì‚¬ (Screening)",
                        content: "CBC & Diff Count, ë©´ì—­ê¸€ë¡œë¶ˆë¦° ì •ëŸ‰(IgG, IgA, IgM, IgE) ê²€ì‚¬ë¥¼ ì‹œí–‰í•©ë‹ˆë‹¤.",
                        detail: "í˜¸ì¤‘êµ¬ ê°ì†Œì¦, ë¦¼í”„êµ¬ ê°ì†Œì¦ì„ í™•ì¸í•˜ê³ , ì €ê°ë§ˆê¸€ë¡œë¶ˆë¦°í˜ˆì¦ ìœ ë¬´ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤. ì´ê²ƒë§Œìœ¼ë¡œë„ XLA, CVID ë“±ì„ ì„ ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                    },
                    {
                        step: 2,
                        title: "2ë‹¨ê³„: ê¸°ëŠ¥ì  í•­ì²´ ë°˜ì‘",
                        content: "ë°±ì‹ (ì˜ˆ: íêµ¬ê· , íŒŒìƒí’) ì ‘ì¢… í›„ í•­ì²´ ì—­ê°€ê°€ ì •ìƒì ìœ¼ë¡œ ìƒìŠ¹í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.",
                        detail: "Ig ìˆ˜ì¹˜ê°€ ì •ìƒì´ë”ë¼ë„ ê¸°ëŠ¥ì´ ë–¨ì–´ì§€ëŠ” 'íŠ¹ì´ í•­ì²´ ê²°í•ì¦'ì„ ì§„ë‹¨í•˜ëŠ” ë° í•„ìˆ˜ì ì…ë‹ˆë‹¤."
                    },
                    {
                        step: 3,
                        title: "3ë‹¨ê³„: ë¦¼í”„êµ¬ ì•„í˜• ë¶„ì„",
                        content: "Flow Cytometryë¥¼ ì´ìš©í•´ Tì„¸í¬(CD3, CD4, CD8), Bì„¸í¬(CD19, CD20), NKì„¸í¬(CD16/56)ì˜ ë¶„í¬ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.",
                        detail: "SCIDì˜ ìœ í˜•(T-B+NK- ë“±)ì„ ë¶„ë¥˜í•˜ê±°ë‚˜, ë¶„ë¥˜ ë¶ˆê°€ëŠ¥í•œ ë©´ì—­ ê²°í•ì˜ í‘œí˜„í˜•ì„ íŒŒì•…í•©ë‹ˆë‹¤."
                    },
                    {
                        step: 4,
                        title: "4ë‹¨ê³„: ìœ ì „ì ê²€ì‚¬ (í™•ì§„)",
                        content: "Targeted Panel Sequencing ë˜ëŠ” Whole Exome Sequencing (WES)ì„ ì‹œí–‰í•©ë‹ˆë‹¤.",
                        detail: "ìµœì¢… í™•ì§„ì„ ë‚´ë¦¬ê³ , ê°€ì¡± ìƒë‹´ ë° ìœ ì „ì ì¹˜ë£Œ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ê·¼ê±°ê°€ ë©ë‹ˆë‹¤."
                    }
                ]
            },
            treatment: {
                intro: "ì¹˜ë£Œì˜ ëª©í‘œëŠ” ê°ì—¼ ì˜ˆë°©ê³¼ ì‚¶ì˜ ì§ˆ í–¥ìƒì…ë‹ˆë‹¤. ê·¼ë³¸ì ì¸ ì¹˜ë£Œ(ì¡°í˜ˆëª¨ì„¸í¬ ì´ì‹ ë“±)ì™€ ë³´ì¡´ì  ì¹˜ë£Œ(ë©´ì—­ê¸€ë¡œë¶ˆë¦° ë³´ì¶©)ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. ì§ˆí™˜ì˜ ì¤‘ì¦ë„ì— ë”°ë¼ ì¹˜ë£Œ ì „ëµì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.",
                comparison: {
                    ivig: {
                        title: "ë©´ì—­ê¸€ë¡œë¶ˆë¦° ë³´ì¶©ìš”ë²• (IVIG/SCIG)",
                        target: "í•­ì²´ ê²°í•ì¦ (XLA, CVID)",
                        method: "ê±´ê°•í•œ ì‚¬ëŒì˜ í˜ˆì¥ ì„±ë¶„ì—ì„œ ì¶”ì¶œí•œ IgGë¥¼ ì •ë§¥(IV) ë˜ëŠ” í”¼í•˜(SC)ë¡œ ì£¼ì….",
                        pros: "ê°ì—¼ ë¹ˆë„ ê¸‰ê°, ë¹„êµì  ì•ˆì „í•¨.",
                        cons: "í‰ìƒ íˆ¬ì—¬ í•„ìš”, ê³ ë¹„ìš©, ì•„ë‚˜í•„ë½ì‹œìŠ¤ ìœ„í—˜(IgA ê²°í• ì‹œ)."
                    },
                    hsct: {
                        title: "ì¡°í˜ˆëª¨ì„¸í¬ ì´ì‹ (HSCT)",
                        target: "ì¤‘ì¦ ë³µí•© ë©´ì—­ê²°í•ì¦ (SCID), ì¤‘ì¦ CGD",
                        method: "ê²°í•¨ì´ ìˆëŠ” ê³¨ìˆ˜ë¥¼ ì œê±°í•˜ê³  ê±´ê°•í•œ ê³µì—¬ìì˜ ì¡°í˜ˆëª¨ì„¸í¬ë¥¼ ì´ì‹.",
                        pros: "ì™„ì¹˜ ê°€ëŠ¥ (Curative).",
                        cons: "GVHD(ì´ì‹í¸ëŒ€ìˆ™ì£¼ë³‘), ê°ì—¼ ë“± ì´ì‹ ê´€ë ¨ ì‚¬ë§ë¥  ì¡´ì¬, ê³µì—¬ì í™•ë³´ ì–´ë ¤ì›€."
                    }
                }
            }
        };

        // --- APP CONTROLLER ---
        const app = {
            state: {
                currentTab: 'dashboard',
                charts: {}
            },

            init: function() {
                this.navigate('dashboard');
                // Mobile menu styling adjustment handled by CSS/Tailwind
            },

            navigate: function(tabId) {
                this.state.currentTab = tabId;
                
                // Update UI Nav
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('nav-active', 'text-blue-600');
                    btn.classList.add('text-gray-500');
                });
                const activeBtn = document.getElementById(`nav-${tabId}`);
                if (activeBtn) {
                    activeBtn.classList.add('nav-active', 'text-blue-600');
                    activeBtn.classList.remove('text-gray-500');
                }

                // Clean up old charts
                Object.values(this.state.charts).forEach(chart => chart.destroy());
                this.state.charts = {};

                // Render Content
                const container = document.getElementById('main-container');
                container.innerHTML = ''; // Clear content
                
                switch(tabId) {
                    case 'dashboard':
                        this.renderDashboard(container);
                        break;
                    case 'patho':
                        this.renderPatho(container);
                        break;
                    case 'diagnosis':
                        this.renderDiagnosis(container);
                        break;
                    case 'treatment':
                        this.renderTreatment(container);
                        break;
                }
            },

            // --- RENDERERS ---

            renderDashboard: function(container) {
                const data = reportData.dashboard;
                
                // Section Header
                const sectionHtml = `
                    <div class="fade-in max-w-5xl mx-auto space-y-8">
                        <section class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <h2 class="text-2xl font-bold text-gray-800 mb-3">ì§ˆí™˜ ê°œìš” (Overview)</h2>
                            <p class="text-gray-600 leading-relaxed">${data.intro}</p>
                        </section>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Chart Section -->
                            <section class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center">
                                <h3 class="text-lg font-semibold text-gray-700 mb-4 w-full text-left border-l-4 border-blue-500 pl-3">ë©´ì—­ ê²°í• ìœ í˜•ë³„ ë¶„í¬</h3>
                                <div class="chart-wrapper">
                                    <canvas id="prevalenceChart"></canvas>
                                </div>
                                <p class="mt-4 text-sm text-gray-500 text-center bg-gray-50 p-3 rounded-lg w-full">
                                    ğŸ’¡ <strong>Insight:</strong> ${data.stats.details}
                                </p>
                            </section>

                            <!-- Warning Signs -->
                            <section class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                <h3 class="text-lg font-semibold text-gray-700 mb-4 w-full text-left border-l-4 border-red-500 pl-3">10ëŒ€ ê²½ê³  ì§•í›„ (Warning Signs)</h3>
                                <div class="grid grid-cols-2 gap-3 h-[350px] overflow-y-auto custom-scrollbar pr-1">
                                    ${data.warningSigns.map(sign => `
                                        <div class="group bg-red-50 hover:bg-red-100 p-3 rounded-lg cursor-pointer transition-all duration-200 border border-transparent hover:border-red-200"
                                             onclick="alert('${sign.desc}')" title="í´ë¦­í•˜ì—¬ ìƒì„¸ ì„¤ëª… í™•ì¸">
                                            <div class="flex items-center justify-between mb-1">
                                                <span class="text-red-600 font-bold text-lg">${sign.id}</span>
                                                <span class="text-xs text-red-400">Tap details</span>
                                            </div>
                                            <h4 class="font-bold text-gray-800 text-sm">${sign.title}</h4>
                                            <p class="text-xs text-gray-600 mt-1 hidden group-hover:block animate-fade-in">${sign.desc}</p>
                                        </div>
                                    `).join('')}
                                </div>
                                <p class="text-xs text-gray-400 mt-2 text-right">*ì¶œì²˜: Jeffrey Modell Foundation</p>
                            </section>
                        </div>
                    </div>
                `;
                container.innerHTML = sectionHtml;

                // Init Chart
                const ctx = document.getElementById('prevalenceChart').getContext('2d');
                this.state.charts.prevalence = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: data.stats.labels,
                        datasets: [{
                            data: data.stats.data,
                            backgroundColor: ['#3B82F6', '#6366F1', '#10B981', '#F59E0B', '#9CA3AF'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { boxWidth: 12, padding: 15 } }
                        }
                    }
                });
            },

            renderPatho: function(container) {
                const data = reportData.patho;
                
                const sectionHtml = `
                    <div class="fade-in max-w-5xl mx-auto space-y-8">
                        <section class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <h2 class="text-2xl font-bold text-gray-800 mb-3">ë³‘íƒœìƒë¦¬ ë° ê²°í•¨ ìœ„ì¹˜</h2>
                            <p class="text-gray-600 leading-relaxed mb-6">${data.intro}</p>
                            
                            <!-- Interactive Flow UI -->
                            <div class="flex flex-col md:flex-row gap-4 items-stretch justify-center mb-8 relative">
                                <!-- Connection Lines (Visual only, simple borders) -->
                                <div class="hidden md:block absolute top-1/2 left-0 w-full h-1 bg-gray-200 -z-0"></div>

                                ${data.stages.map((stage, index) => `
                                    <button onclick="app.showPathoDetail('${stage.id}')" 
                                            class="z-10 relative flex-1 bg-white border-2 border-gray-200 hover:border-blue-500 rounded-xl p-4 shadow-sm hover:shadow-md transition-all text-center group focus:outline-none focus:ring-2 focus:ring-blue-300">
                                        <div class="w-8 h-8 mx-auto bg-gray-100 text-gray-500 rounded-full flex items-center justify-center mb-2 font-bold group-hover:bg-blue-100 group-hover:text-blue-600">
                                            ${index + 1}
                                        </div>
                                        <span class="font-semibold text-gray-700 text-sm block">${stage.label}</span>
                                    </button>
                                `).join('')}
                            </div>

                            <!-- Detail Panel (Dynamic) -->
                            <div id="patho-detail-panel" class="bg-blue-50 border border-blue-100 rounded-xl p-6 text-center transition-all">
                                <p class="text-blue-800 font-medium">ìœ„ì˜ ë‹¨ê³„ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê´€ë ¨ëœ ë©´ì—­ ê²°í• ì§ˆí™˜ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                            </div>
                        </section>
                    </div>
                `;
                container.innerHTML = sectionHtml;
            },

            showPathoDetail: function(id) {
                const stage = reportData.patho.stages.find(s => s.id === id);
                const panel = document.getElementById('patho-detail-panel');
                
                panel.innerHTML = `
                    <div class="fade-in text-left">
                        <div class="flex items-center mb-2">
                            <span class="bg-blue-600 text-white text-xs px-2 py-1 rounded mr-2">ë‹¨ê³„: ${stage.label}</span>
                            <h3 class="text-xl font-bold text-gray-900">${stage.disease}</h3>
                        </div>
                        <hr class="border-blue-200 my-3">
                        <p class="text-gray-700 leading-relaxed">${stage.desc}</p>
                    </div>
                `;
                panel.className = "bg-white border-l-4 border-blue-500 rounded-r-xl p-6 shadow-md transition-all";
            },

            renderDiagnosis: function(container) {
                const data = reportData.diagnosis;

                const sectionHtml = `
                    <div class="fade-in max-w-4xl mx-auto space-y-6">
                        <section class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <h2 class="text-2xl font-bold text-gray-800 mb-3">ì§„ë‹¨ì  ì ‘ê·¼ (Diagnostic Approach)</h2>
                            <p class="text-gray-600 leading-relaxed mb-6">${data.intro}</p>

                            <!-- Vertical Stepper -->
                            <div class="space-y-4">
                                ${data.steps.map(step => `
                                    <div class="relative pl-8 md:pl-0">
                                        <!-- Mobile Line -->
                                        <div class="md:hidden absolute left-3 top-0 bottom-0 w-0.5 bg-gray-200"></div>

                                        <div class="flex flex-col md:flex-row md:items-start gap-4">
                                            <!-- Step Indicator -->
                                            <div class="hidden md:flex flex-col items-center mr-4 mt-1">
                                                <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold z-10">
                                                    ${step.step}
                                                </div>
                                                ${step.step !== 4 ? '<div class="h-full w-0.5 bg-gray-200 my-2"></div>' : ''}
                                            </div>

                                            <!-- Card -->
                                            <div class="flex-1 bg-white border border-gray-200 rounded-lg p-5 hover:border-blue-300 transition-colors cursor-pointer group shadow-sm"
                                                 onclick="this.querySelector('.detail-content').classList.toggle('hidden');">
                                                <div class="flex justify-between items-center mb-2">
                                                    <h3 class="font-bold text-gray-800 text-lg">
                                                        <span class="md:hidden text-blue-600 mr-2">${step.step}.</span>
                                                        ${step.title}
                                                    </h3>
                                                    <span class="text-gray-400 text-sm group-hover:text-blue-500">â–¼ ìƒì„¸ ë³´ê¸°</span>
                                                </div>
                                                <p class="text-gray-600">${step.content}</p>
                                                
                                                <!-- Toggleable Detail -->
                                                <div class="detail-content hidden mt-4 pt-4 border-t border-gray-100 bg-gray-50 -mx-5 -mb-5 p-5 rounded-b-lg">
                                                    <p class="text-sm text-gray-700"><span class="font-bold text-blue-600">ì„ìƒì  ì˜ì˜:</span> ${step.detail}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </section>
                    </div>
                `;
                container.innerHTML = sectionHtml;
            },

            renderTreatment: function(container) {
                const data = reportData.treatment;

                const sectionHtml = `
                    <div class="fade-in max-w-5xl mx-auto space-y-8">
                        <section class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                            <h2 class="text-2xl font-bold text-gray-800 mb-3">ì¹˜ë£Œ ê°€ì´ë“œë¼ì¸ (Treatment)</h2>
                            <p class="text-gray-600 leading-relaxed mb-6">${data.intro}</p>

                            <!-- Treatment Comparison Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                <!-- IVIG Card -->
                                <div class="bg-blue-50 border border-blue-100 rounded-xl p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="font-bold text-xl text-blue-800">${data.comparison.ivig.title}</h3>
                                        <span class="bg-white text-blue-600 text-xs px-2 py-1 rounded border border-blue-200">ë³´ì¡´ì  ì¹˜ë£Œ</span>
                                    </div>
                                    <ul class="space-y-3 text-sm text-gray-700">
                                        <li><strong>ëŒ€ìƒ:</strong> ${data.comparison.ivig.target}</li>
                                        <li><strong>ë°©ë²•:</strong> ${data.comparison.ivig.method}</li>
                                        <li class="text-green-700"><strong>ì¥ì :</strong> ${data.comparison.ivig.pros}</li>
                                        <li class="text-red-700"><strong>ë‹¨ì :</strong> ${data.comparison.ivig.cons}</li>
                                    </ul>
                                </div>

                                <!-- HSCT Card -->
                                <div class="bg-orange-50 border border-orange-100 rounded-xl p-6">
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="font-bold text-xl text-orange-800">${data.comparison.hsct.title}</h3>
                                        <span class="bg-white text-orange-600 text-xs px-2 py-1 rounded border border-orange-200">ê·¼ë³¸ì  ì¹˜ë£Œ</span>
                                    </div>
                                    <ul class="space-y-3 text-sm text-gray-700">
                                        <li><strong>ëŒ€ìƒ:</strong> ${data.comparison.hsct.target}</li>
                                        <li><strong>ë°©ë²•:</strong> ${data.comparison.hsct.method}</li>
                                        <li class="text-green-700"><strong>ì¥ì :</strong> ${data.comparison.hsct.pros}</li>
                                        <li class="text-red-700"><strong>ë‹¨ì :</strong> ${data.comparison.hsct.cons}</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Survival Chart -->
                            <div class="bg-white rounded-xl p-6 border border-gray-200">
                                <h3 class="text-lg font-bold text-gray-800 mb-4">ì¹˜ë£Œ ì‹œê¸°ì— ë”°ë¥¸ ìƒì¡´ìœ¨ (SCID ì˜ˆì‹œ)</h3>
                                <div class="chart-wrapper">
                                    <canvas id="survivalChart"></canvas>
                                </div>
                                <p class="text-sm text-gray-500 mt-4 text-center">
                                    *ê°€ìƒ ë°ì´í„°: ìƒí›„ 3.5ê°œì›” ì´ë‚´ ì¡°ê¸° ì´ì‹ ì‹œ ìƒì¡´ìœ¨ì´ í˜„ì €íˆ ë†’ìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
                                </p>
                            </div>
                        </section>
                    </div>
                `;
                container.innerHTML = sectionHtml;

                // Init Chart
                const ctx = document.getElementById('survivalChart').getContext('2d');
                this.state.charts.survival = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['1ë…„', '5ë…„', '10ë…„', '20ë…„'],
                        datasets: [
                            {
                                label: 'ì¡°ê¸° ì§„ë‹¨ ë° ì´ì‹ (<3.5ê°œì›”)',
                                data: [95, 94, 92, 90],
                                borderColor: '#10B981', // Emerald 500
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                tension: 0.3,
                                fill: true
                            },
                            {
                                label: 'ì§€ì—°ëœ ì§„ë‹¨ ë° ì´ì‹ (>3.5ê°œì›”)',
                                data: [70, 65, 60, 55],
                                borderColor: '#EF4444', // Red 500
                                backgroundColor: 'rgba(239, 68, 68, 0.05)',
                                tension: 0.3,
                                fill: false,
                                borderDash: [5, 5]
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            tooltip: { mode: 'index', intersect: false },
                            legend: { position: 'top' }
                        },
                        scales: {
                            y: { min: 0, max: 100, title: { display: true, text: 'ìƒì¡´ìœ¨ (%)' } },
                            x: { title: { display: true, text: 'ê²½ê³¼ ê¸°ê°„' } }
                        }
                    }
                });
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
</body>
</html>